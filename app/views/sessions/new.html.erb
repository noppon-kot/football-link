<div class="app-shell">
  <header class="app-header">
    <div class="app-top-nav">
      <%= link_to "←", root_path, class: "app-top-nav-left", style: "text-decoration:none;" %>
      <div class="app-top-nav-center"><%= t('sessions.form.header') %></div>
      <div class="app-top-nav-right"></div>
    </div>
    <div class="app-header-title"><%= t('sessions.form.header') %></div>
  </header>

  <div class="tournament-form">
    <%= form_with url: login_path, scope: :session, local: true do |f| %>
      <div class="tournament-form-group">
        <label><%= t('sessions.form.select_user_label') %></label>
        <%= f.select :user_id,
              options_from_collection_for_select(@users, :id, :name),
              { include_blank: t('sessions.form.select_placeholder') },
              class: "tournament-form-input" %>
      </div>

      <div class="tournament-form-group">
        <label>รหัสผ่าน</label>
        <%= f.password_field :password, class: "tournament-form-input", autocomplete: "off" %>
      </div>

      <div class="tournament-form-actions">
        <%= f.submit t('sessions.form.submit'), class: "link-button" %>
      </div>
    <% end %>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    var userSelect = document.querySelector('select[name="session[user_id]"]');
    var passwordInput = document.querySelector('input[name="session[password]"]');

    if (!userSelect || !passwordInput) return;

    function updatePassword() {
      var selectedOption = userSelect.options[userSelect.selectedIndex];
      if (!selectedOption) {
        passwordInput.value = "";
        return;
      }

      var label = (selectedOption.text || "").toLowerCase();

      if (label.indexOf("admin") !== -1) {
        passwordInput.value = "";
      } else if (userSelect.value) {
        passwordInput.value = "qwer";
      } else {
        passwordInput.value = "";
      }
    }

    userSelect.addEventListener("change", updatePassword);
  });
</script>
