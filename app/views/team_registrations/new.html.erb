<div class="app-shell">
  <header class="app-header">
    <div class="app-top-nav">
      <%= link_to "←", tournament_path(@tournament), class: "app-top-nav-left", style: "text-decoration:none;" %>
      <div class="app-top-nav-center"><%= t('team_registrations.form.header.title_short') %></div>
      <div class="app-top-nav-right"></div>
    </div>
    <div class="app-header-title"><%= t('team_registrations.form.header.title_full') %></div>
  </header>
  <div class="container py-3">
    <div class="card shadow-sm">
      <div class="card-body">
        <% if flash[:alert].present? %>
          <div class="alert alert-danger" role="alert">
            <div>กรุณาตรวจสอบข้อมูลการสมัครทีม</div>
            <ul class="mb-0 ps-3">
              <li><%= flash[:alert] %></li>
            </ul>
          </div>
        <% end %>

        <%= form_with url: tournament_team_registrations_path(@tournament), scope: :registration, local: true do |f| %>
          <div class="mb-3">
            <label class="form-label"><%= t('team_registrations.form.fields.tournament') %></label>
            <div class="form-control-plaintext"><%= @tournament.title %></div>
          </div>

          <% if @divisions.size > 1 %>
            <div class="mb-3">
              <label class="form-label"><%= t('team_registrations.form.fields.division') %></label>
              <%= f.select :tournament_division_id,
                    options_from_collection_for_select(@divisions, :id, :name),
                    { include_blank: t('team_registrations.form.placeholders.division') },
                    class: "form-select" %>
            </div>
          <% elsif @divisions.size == 1 %>
            <div class="mb-3">
              <label class="form-label"><%= t('team_registrations.form.fields.division') %></label>
              <div class="form-control-plaintext"><%= @divisions.first.name %></div>
              <%= f.hidden_field :tournament_division_id, value: @divisions.first.id %>
            </div>
          <% end %>

          <div class="mb-3">
            <label class="form-label"><%= t('team_registrations.form.fields.team_name') %></label>
            <%= f.text_field :team_name,
                  class: "form-control",
                  placeholder: t('team_registrations.form.placeholders.team_name') %>
          </div>

          <div class="mb-3">
            <label class="form-label"><%= t('team_registrations.form.fields.contact_name') %></label>
            <%= f.text_field :contact_name,
                  class: "form-control",
                  placeholder: t('team_registrations.form.placeholders.contact_name'),
                  value: (params.dig(:registration, :contact_name) || current_user&.name) %>
          </div>

          <div class="mb-3">
            <label class="form-label"><%= t('team_registrations.form.fields.contact_phone') %></label>
            <%= f.telephone_field :contact_phone,
                  class: "form-control",
                  placeholder: t('team_registrations.form.placeholders.contact_phone') %>
          </div>

          <div class="mb-3">
            <label class="form-label">โลโก้ทีม (อัปโหลดรูป)</label>
            <%= f.file_field :logo, class: "form-control" %>
          </div>

          <div class="mb-3">
            <label class="form-label">LINE ID ผู้ติดต่อทีม (ไม่บังคับ)</label>
            <%= f.text_field :line_id,
                  class: "form-control",
                  value: (params.dig(:registration, :line_id) || current_user&.line_id) %>
          </div>

          <div class="d-flex justify-content-end">
            <%= f.submit t('team_registrations.form.submit'), class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
