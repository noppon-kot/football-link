<div class="app-shell">
  <header class="app-header">
    <div class="app-top-nav">
      <div class="app-top-nav-left">‚â°</div>
      <div class="app-top-nav-center">‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏≤‡∏¢</div>
      <div class="app-top-nav-right">
        <span>üîç</span>
        <span>‚ò∞</span>
      </div>
    </div>
    <div class="app-header-title">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á</div>
  </header>

  <div class="province-filter-form">
    <%= form_with url: tournaments_path, method: :get, local: true do |f| %>
      <div class="filter-row" style="margin-bottom: 8px;">
        <%= f.text_field :q, value: params[:q], placeholder: "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤...", class: "filter-text-input" %>
        <button type="submit" class="filter-search-button">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      </div>

      <div class="filter-row">
        <div class="filter-pill-select">
          <%= f.select :age_category,
                options_for_select([["‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏", ""]] + @age_categories.map { |a| [a, a] }, params[:age_category]),
                {},
                class: "",
                onchange: "this.form.submit()" %>
        </div>

        <div class="filter-pill-select">
          <%= f.select :province,
                options_for_select([["‡∏ó‡∏∏‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", ""]] + @provinces.map { |p| [p, p] }, params[:province]),
                {},
                class: "",
                onchange: "this.form.submit()" %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="filter-bar">
    <span class="filter-pill">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏Å‡∏•‡πâ‡∏ï‡∏±‡∏ß</span>
    <% if params[:province].present? %>
      <span>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: <strong><%= params[:province] %></strong></span>
    <% else %>
      <span>‡∏ó‡∏∏‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</span>
    <% end %>
  </div>

  <div class="tournament-list">
    <% if @tournaments.any? %>
      <% @tournaments.each do |tournament| %>
        <% bg_class = begin
             age = tournament.age_category.to_s
             if age =~ /\AU(\d+)\z/ && $1.to_i < 20
               "tournament-card--bg1"
             else
               "tournament-card--bg2"
             end
           end %>
        <div class="tournament-card <%= bg_class %>">
          <div class="tournament-card-body">
            <div class="tournament-title"><%= link_to tournament.title, tournament_path(tournament), style: "color: inherit; text-decoration: none;" %></div>
            <div class="tournament-meta">
              <div>7 - 8 ‡∏Å.‡∏û. 2026</div>
              <div>üìç <%= tournament.location_name %> ¬∑ <%= tournament.city %>, <%= tournament.province %></div>
              <div>üë• ‡∏ó‡∏µ‡∏°‡∏•‡∏∞ <%= tournament.team_size %> ‡∏Ñ‡∏ô</div>
              <div class="tournament-meta-divider"></div>
              <div>üèÜ ‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• <%= number_to_currency(tournament.prize_amount, unit: "‡∏ø", precision: 0) %> ¬∑ ‡∏Ñ‡πà‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£ <%= number_to_currency(tournament.entry_fee, unit: "‡∏ø", precision: 0) %></div>
            </div>
          </div>
          <div class="tournament-footer">
            <div class="tournament-footer-left">
              <span class="tournament-footer-dot"></span>
              <span class="tournament-footer-text">‡∏°‡∏µ‡∏ó‡∏µ‡∏°‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏°‡∏±‡∏Ñ‡∏£ <%= rand(5..20) %> ‡∏ó‡∏µ‡∏°</span>
            </div>
            <div class="tournament-footer-actions">
              <%= link_to "‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏°‡∏±‡∏Ñ‡∏£", tournament_path(tournament), class: "btn-pill btn-interest" %>
              <%= link_to "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", tournament_path(tournament), class: "btn-pill btn-apply" %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="tournaments-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏µ‡πâ</div>
    <% end %>
  </div>

  <% if @total_pages > 1 %>
    <div class="pagination">
      <% if @current_page > 1 %>
        <%= link_to "‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤", tournaments_path(request.query_parameters.merge(page: @current_page - 1)), class: "pagination-link" %>
      <% end %>

      <% (1..@total_pages).each do |page| %>
        <% if page == @current_page %>
          <span class="pagination-link pagination-link--active"><%= page %></span>
        <% else %>
          <%= link_to page, tournaments_path(request.query_parameters.merge(page: page)), class: "pagination-link" %>
        <% end %>
      <% end %>

      <% if @current_page < @total_pages %>
        <%= link_to "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ", tournaments_path(request.query_parameters.merge(page: @current_page + 1)), class: "pagination-link" %>
      <% end %>
    </div>
  <% end %>
</div>
